# 页面渲染

*创建于：2018-11-08；更新于：2018-11-08*

本文内容仅是个人观点和网上推论的总结

## 浏览器渲染机制以及流程

1. 解析html，创建DOM树
1. 创建CSSOM(css对象模型)
1. 生成渲染树
1. 计算元素大小位置等
1. 绘制页面

注意点：

1. 渲染树不等于DOM树，比如display：none的元素
1. js会阻断html解析，如果是内嵌JS，则先执行后再继续解析，如果是外部JS，则会先加载并执行后再解析
1. 外部css会阻断js的执行，如果有外部css，会先加载并创建CSSOM之后再执行JS(js可以获得CSSOM)，但是JS会提前请求回来
1. 建议把css放在head，把js放在body底部之前
1. html没解析完，先解析的部分可能已经渲染到页面了
1. 动态js不会阻断html解析

## 情景
- 如果没有js，css代码

    直接从头到尾解析

- 如果有css没有js

    遇到css不会阻断html解析

- 如果有js没有css

    遇到js，会先加载执行js再继续解析

- 如果有css和js

    遇到css会先加载并执行，再加载js(会提前加载)并执行，之后继续解析

## defer和async的区别

**defer(延迟执行)**： DOMcontentloaded之前按照顺序执行

**async(异步执行)**：加载完就执行，不保证顺序

**动态创建**：通过动态创建script标签不会阻断html解析

DOMcontentloaded事件在onload之前执行

## 重排(回流)和重绘

**重排**：重新计算大小位置等

**重绘**：改变背景颜色和字体颜色等

重排消耗的资源大于重绘

